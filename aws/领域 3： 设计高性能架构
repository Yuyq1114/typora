# 任务表述 3.1： 确定高性能和/或可扩展的存储解决方案。

存储优化（EBS、EFS、S3）

## ☁️ 一、AWS 存储体系总览

AWS 存储服务按照用途分为三大类：

| 类别                           | 服务                         | 特点                             | 典型用途               |
| ------------------------------ | ---------------------------- | -------------------------------- | ---------------------- |
| **块存储（Block Storage）**    | EBS（Elastic Block Store）   | 挂载到 EC2 实例，低延迟、高 IOPS | 操作系统盘、数据库存储 |
| **文件存储（File Storage）**   | EFS（Elastic File System）   | 多实例共享、POSIX 文件系统       | 容器/微服务共享文件    |
| **对象存储（Object Storage）** | S3（Simple Storage Service） | 海量、低成本、高持久性           | 静态网站、备份、数据湖 |

可以这么理解：

> EC2 ➜ EBS
>  多 EC2 ➜ EFS
>  海量文件/数据归档 ➜ S3

------

## 🧱 二、Amazon EBS（Elastic Block Store）

### 🔹 定义

EBS 是 **块级存储（Block Storage）** 服务，提供可附加到 EC2 实例的持久化磁盘。

- 类似于传统服务器的 **硬盘（HDD/SSD）**；
- 可单独快照、复制、加密；
- 当 EC2 停止或重启时，EBS 数据依然存在。

------

### 🔹 类型分类（按性能优化）

| 类型    | 性能类别     | 特点                | IOPS / 吞吐量     | 场景               |
| ------- | ------------ | ------------------- | ----------------- | ------------------ |
| **gp3** | 通用型 SSD   | 默认推荐            | 3,000–16,000 IOPS | 通用服务器、数据库 |
| **io2** | 高性能 SSD   | 稳定 IOPS、高耐久性 | 最高 256,000 IOPS | 企业数据库、OLTP   |
| **st1** | 吞吐优化 HDD | 面向大数据流式访问  | 吞吐高，IOPS低    | 日志、流媒体       |
| **sc1** | 冷存储 HDD   | 成本最低            | 吞吐低            | 归档、低频访问数据 |

✅ 默认推荐：**gp3**
 相比旧版 gp2，gp3 可**独立设置容量与性能**，性价比更高。

------

### 🔹 优化技巧

| 技术                 | 说明                                   | 效果                    |
| -------------------- | -------------------------------------- | ----------------------- |
| **EBS Multi-Attach** | 同一个卷可挂载到多个 EC2（仅 io1/io2） | 高可用数据库集群        |
| **EBS Snapshots**    | 将卷备份到 S3                          | 灾备与快速恢复          |
| **EBS Encryption**   | 使用 KMS 加密数据                      | 安全合规                |
| **Provisioned IOPS** | 提前预置性能                           | 保证高负载场景性能稳定  |
| **Placement Group**  | EC2 物理邻近部署                       | 降低延迟，提升 I/O 性能 |

------

### 🔹 EBS 性能优化建议

✅ 使用 **gp3 + Provisioned IOPS** 优化性能；
 ✅ 在数据库等高负载系统中选择 **io2 Block Express**；
 ✅ 对关键数据启用 **自动快照 + 跨区复制**；
 ✅ 在高并发读写场景中，考虑 **多卷 RAID 0** 以增加带宽。

------

## 📂 三、Amazon EFS（Elastic File System）

### 🔹 定义

EFS 是 **共享文件系统（File Storage）**，可同时挂载到多个 EC2 实例。
 完全托管、弹性扩展、兼容 NFS 协议（Linux）。

- 类似于企业内部的 **NAS 文件服务器**；
- 不需要预分配容量；
- 自动扩展存储容量和吞吐量。

------

### 🔹 EFS 的优势

| 特性         | 说明                              |
| ------------ | --------------------------------- |
| **共享访问** | 多个 EC2 同时挂载（读写共享）     |
| **弹性扩展** | 自动随文件数量增长                |
| **高可用性** | 数据分布在多个 AZ                 |
| **安全控制** | 支持 IAM + VPC 安全组访问控制     |
| **备份**     | EFS Backup / Lifecycle Management |

------

### 🔹 存储类别

| 存储类型                       | 成本                        | 性能           | 场景           |
| ------------------------------ | --------------------------- | -------------- | -------------- |
| **EFS Standard**               | 较高                        | 高性能、低延迟 | 频繁访问数据   |
| **EFS Infrequent Access (IA)** | 较低                        | 延迟略高       | 不常访问的文件 |
| **EFS Lifecycle Policy**       | 自动在 Standard ↔ IA 间迁移 | 降低成本       |                |

------

### 🔹 性能模式

| 模式                | 特点           | 适用场景             |
| ------------------- | -------------- | -------------------- |
| **General Purpose** | 低延迟（默认） | Web 服务、小规模应用 |
| **Max I/O**         | 高并发吞吐     | 大数据分析、媒体处理 |

------

### 🔹 吞吐模式

| 模式                       | 特点               | 适用场景       |
| -------------------------- | ------------------ | -------------- |
| **Bursting Throughput**    | 吞吐随用量自动增加 | 小型动态负载   |
| **Provisioned Throughput** | 固定高吞吐         | 稳定高流量系统 |

------

### 🔹 最佳实践

✅ 启用 **Lifecycle Policy** 自动节省 IA 成本；
 ✅ 多 AZ 挂载实现高可用性；
 ✅ 对高并发访问启用 **Max I/O 模式**；
 ✅ 对 NFS 客户端配置适当缓存参数（提升性能）。

------

## 🪣 四、Amazon S3（Simple Storage Service）

### 🔹 定义

S3 是一种 **对象存储（Object Storage）** 服务，用于存储**海量数据**：
 图片、视频、日志、备份、数据湖文件等。

每个对象由：

- **Key（文件名）**
- **Value（文件内容）**
- **Metadata（元数据）**
   组成。

> 与 EBS/EFS 不同，S3 不能直接“挂载”成文件系统（但可以通过 S3FS、DataSync、Glue、Athena 等访问）。

------

### 🔹 S3 的优势

| 特性         | 说明                         |
| ------------ | ---------------------------- |
| **持久性**   | 99.999999999%（11 个 9）     |
| **高可用**   | 多 AZ 冗余存储               |
| **无限容量** | 自动扩展                     |
| **安全合规** | 支持加密、访问策略、版本控制 |
| **事件驱动** | 可触发 Lambda 函数           |

------

### 🔹 存储类别（Storage Classes）

| 存储类型                          | 成本     | 取回延迟   | 典型场景                       |
| --------------------------------- | -------- | ---------- | ------------------------------ |
| **S3 Standard**                   | 💰 高     | 毫秒       | 高频访问数据（网站、应用资源） |
| **S3 Intelligent-Tiering**        | 自动优化 | 毫秒       | 访问模式变化的文件             |
| **S3 Standard-IA**                | 低       | 毫秒       | 不常访问但需快速取回           |
| **S3 One Zone-IA**                | 更低     | 毫秒       | 可容忍单 AZ 故障的备份数据     |
| **S3 Glacier Instant Retrieval**  | 更低     | 毫秒       | 归档但偶尔访问                 |
| **S3 Glacier Flexible Retrieval** | 极低     | 分钟～小时 | 长期归档                       |
| **S3 Glacier Deep Archive**       | 最低     | 小时级     | 合规性长期保存（如7年）        |

✅ 如果访问模式不确定，用 **S3 Intelligent-Tiering** 最稳妥。

------

### 🔹 成本优化策略

| 策略                         | 说明                       |
| ---------------------------- | -------------------------- |
| **Lifecycle Policy**         | 自动在不同存储层之间迁移   |
| **Intelligent-Tiering**      | 自动检测访问频率并切换层级 |
| **S3 Object Lock**           | 防止数据被修改/删除        |
| **S3 Versioning**            | 启用版本控制以防误删       |
| **S3 Transfer Acceleration** | 提高跨区域上传速度         |
| **Requester Pays**           | 下载成本由访问者承担       |

------

### 🔹 安全与合规

- 使用 **S3 Bucket Policy / IAM Policy** 控制访问；
- 启用 **S3 Block Public Access** 防止误公开；
- 使用 **KMS 加密（SSE-KMS / SSE-S3）**；
- 与 **CloudTrail** 结合实现访问审计。

------

## ⚙️ 五、三者对比总结

| 特性       | EBS                       | EFS              | S3                     |
| ---------- | ------------------------- | ---------------- | ---------------------- |
| 类型       | 块存储                    | 文件存储         | 对象存储               |
| 挂载       | 单实例（或 Multi-Attach） | 多实例共享       | 无需挂载（API 访问）   |
| 性能       | 低延迟、高 IOPS           | 中等延迟、高并发 | 高延迟、超大规模       |
| 容量管理   | 固定容量                  | 自动扩展         | 无限                   |
| 成本       | 中等                      | 较高             | 最低                   |
| 数据持久性 | 99.8%                     | 99.9%            | 99.999999999%          |
| 高可用     | 单 AZ / Multi-AZ 快照     | Multi-AZ         | Multi-AZ（天然）       |
| 最佳用途   | 操作系统盘、数据库        | 多实例共享存储   | 备份、静态资源、数据湖 |

------

## 🧠 六、考试与实践要点总结

| 考点               | 正确设计思路                        |
| ------------------ | ----------------------------------- |
| EC2 操作系统盘     | 使用 EBS gp3                        |
| 数据库高性能存储   | io2 Block Express                   |
| 多实例共享文件系统 | EFS（POSIX 兼容）                   |
| 静态网站托管       | S3 + CloudFront                     |
| 归档数据           | S3 Glacier Deep Archive             |
| 自动分层           | S3 Intelligent-Tiering              |
| 异地备份           | S3 Cross-Region Replication         |
| 成本优化           | EFS Lifecycle Policy / S3 Lifecycle |
| 文件共享服务       | EFS + Mount Targets across AZs      |

------

## 📊 七、综合架构图（存储分层优化）

```
                   ┌──────────────────────────┐
                   │      Route 53 / ALB       │
                   └──────────┬───────────────┘
                              │
                              ▼
                      ┌────────────┐
                      │   EC2 App   │
                      └──────┬──────┘
               ┌─────────────┼─────────────┐
               ▼             ▼             ▼
        EBS (OS/DB Disk)   EFS (Shared FS)   S3 (Object Storage)
          │                  │                 │
          ▼                  ▼                 ▼
   Snapshots to S3   Lifecycle to IA     Glacier for Archival
```

这种分层设计能同时实现：

- 高性能（EBS）
- 高弹性（EFS）
- 低成本与高持久性（S3）

------

## ✅ 八、总结与选型指南

| 场景                   | 推荐服务                                   | 理由             |
| ---------------------- | ------------------------------------------ | ---------------- |
| 操作系统盘 / 数据库    | **EBS gp3 / io2**                          | 高 IOPS、低延迟  |
| 多 EC2 共享文件        | **EFS**                                    | 共享、自动扩展   |
| 静态资源 / 备份 / 日志 | **S3 Standard / IA**                       | 高持久性、低成本 |
| 长期归档               | **S3 Glacier / Deep Archive**              | 极低成本         |
| 异地灾备               | **S3 CRR / EBS Snapshot Copy**             | 跨区冗余         |
| 成本自动优化           | **EFS Lifecycle / S3 Intelligent-Tiering** | 自动节省存储费   |



# 任务表述 3.2： 设计高性能的弹性计算解决方案。

弹性计算（EC2、Fargate、Lambda）

## ☁️ 一、弹性计算的核心思想

### 🔹 定义

弹性计算（Elastic Compute）指云平台能**根据需求自动增加或减少计算资源**，以保证系统既有性能又能控制成本。

在 AWS 中的三种主要形态：

| 模型                 | 服务          | 特点                               |
| -------------------- | ------------- | ---------------------------------- |
| **虚拟机级（IaaS）** | EC2           | 自主控制、灵活、传统服务器式部署   |
| **容器级（CaaS）**   | ECS + Fargate | 容器管理、免维护服务器             |
| **函数级（FaaS）**   | Lambda        | 完全无服务器、事件驱动、按调用计费 |

------

## 🧱 二、Amazon EC2（Elastic Compute Cloud）

### 🔹 定义

**EC2** 是 AWS 的基础计算服务，提供可伸缩的虚拟服务器（虚机）。
 你可以选择实例类型、存储、操作系统、网络配置等，完全控制计算环境。

------

## 🧩 EC2 架构核心组成

| 组件                            | 说明                            |
| ------------------------------- | ------------------------------- |
| **AMI（Amazon Machine Image）** | EC2 启动模板（操作系统 + 应用） |
| **Instance Type**               | 决定 CPU、内存、网络性能        |
| **EBS Volume**                  | 持久化存储卷                    |
| **Security Group**              | 实例防火墙                      |
| **Elastic IP**                  | 固定公网 IP                     |
| **User Data**                   | 实例启动时执行的初始化脚本      |

------

## ⚙️ 实例类型分类

| 系列           | 优化方向           | 示例     | 适用场景                     |
| -------------- | ------------------ | -------- | ---------------------------- |
| **T 系列**     | 通用型（突发性能） | t4g, t3  | 小型网站、低负载服务         |
| **M 系列**     | 通用型（平衡）     | m6i, m7g | 中型应用、企业后台           |
| **C 系列**     | 计算优化           | c7g, c7i | 高 CPU 比重任务（API、推理） |
| **R 系列**     | 内存优化           | r7g      | 内存密集型数据库             |
| **P/G 系列**   | GPU 计算           | p5, g6   | AI 训练、推理、视频渲染      |
| **I/D/H 系列** | 存储优化           | i4i, d3  | 大数据、日志分析             |

> ✅ SAA 考试常考点：
>  “如果工作负载是 CPU 密集型 → 选 C 系列；
>  内存密集型 → 选 R 系列；
>  通用型 → 选 M 系列。”

------

## 🔹 部署与弹性

- **Auto Scaling Group (ASG)**：根据负载自动增加或减少 EC2 实例；
- **Elastic Load Balancing (ELB)**：将流量均衡分发到多个实例；
- **Placement Group**：
  - Cluster：低延迟、高带宽（适合 HPC）；
  - Spread：不同硬件节点，提升容错；
  - Partition：数据分片场景（如 Hadoop）。

------

## 🔹 成本优化方式

| 模式                       | 特点                          | 场景                 |
| -------------------------- | ----------------------------- | -------------------- |
| **On-Demand**              | 按小时/秒计费                 | 不固定使用量         |
| **Reserved Instance (RI)** | 1-3 年预留，低至 75% 折扣     | 稳定长期业务         |
| **Savings Plans**          | 灵活节省模式（Compute / EC2） | 按消费承诺折扣       |
| **Spot Instance**          | 竞价实例，最高可省 90%        | 弹性任务、容器批处理 |
| **Dedicated Host**         | 专属物理机                    | 合规性需求           |

------

## 🔹 优化与安全建议

✅ 启用 **CloudWatch Agent** 监控 CPU、网络等指标；
 ✅ 使用 **IAM Role** 而不是硬编码密钥；
 ✅ 将用户数据脚本放在 **User Data** 启动时自动执行；
 ✅ 结合 **EBS Snapshots** 实现持久化备份；
 ✅ 使用 **Auto Scaling + ALB** 实现高可用。

------

## 🐳 三、AWS Fargate（Serverless 容器计算）

### 🔹 定义

**Fargate** 是一种 **无服务器（Serverless）容器引擎**，可运行 **ECS**（Elastic Container Service）或 **EKS**（Elastic Kubernetes Service）中的容器任务，而无需管理底层 EC2 实例。

> 简单理解：
>  EC2 + ECS = 传统容器托管
>  ECS + Fargate = 无需服务器，完全自动伸缩

------

## 🧩 架构原理

```
用户定义任务(Task Definition)
        ↓
ECS/EKS 调度容器任务
        ↓
Fargate 自动分配计算资源
```

- 你只需定义 CPU / 内存；
- AWS 自动创建、管理、伸缩容器实例；
- 按秒计费，按任务运行时间收费。

------

## 🔹 优势

| 特性                  | 说明                           |
| --------------------- | ------------------------------ |
| **无需管理 EC2 集群** | Fargate 负责底层节点维护       |
| **精确按任务计费**    | 按任务运行时间付费             |
| **自动扩缩容**        | 任务量变化时自动伸缩           |
| **安全隔离**          | 每个任务独立运行在虚拟化环境中 |
| **与 ECS/EKS 集成**   | 支持 Docker 与 Kubernetes      |

------

## 🔹 Fargate vs EC2 模式（ECS）

| 比较项   | ECS on EC2         | ECS on Fargate   |
| -------- | ------------------ | ---------------- |
| 管理方式 | 需自行维护集群节点 | AWS 全托管       |
| 计费方式 | 按 EC2 实例        | 按任务 CPU/内存  |
| 可控性   | 高（可自定义 AMI） | 较低             |
| 启动速度 | 较慢               | 快               |
| 成本     | 对大规模任务更划算 | 对小规模任务更省 |

------

## 🔹 成本优化

✅ 为任务定义精确的 **vCPU/Memory** 配置；
 ✅ 对周期性任务结合 **ECS Scheduled Tasks**；
 ✅ 使用 **Spot Fargate** 降低成本（最高节省 70%）；
 ✅ 日志统一输出到 **CloudWatch Logs**。

------

## 🔹 常见使用场景

- API 微服务（短生命周期）；
- 容器化批处理；
- 定时任务或事件驱动任务；
- 无需维护的可扩展容器后端。

------

## ⚡ 四、AWS Lambda（Function as a Service）

### 🔹 定义

**Lambda** 是完全无服务器（Serverless）的计算服务。
 你上传函数代码，定义触发事件（Event），AWS 自动执行并伸缩，无需关心服务器。

------

## 🧩 架构模型

```
Event Source (触发器)
        ↓
 AWS Lambda Function
        ↓
   执行逻辑 → 输出结果
```

Lambda 可以被多种事件触发：

- S3（对象上传）
- API Gateway（HTTP 调用）
- DynamoDB Streams（数据库变更）
- SNS/SQS（消息通知）
- CloudWatch（定时任务）

------

## 🔹 优势

| 特性             | 说明                                   |
| ---------------- | -------------------------------------- |
| **无需服务器**   | AWS 自动分配计算资源                   |
| **自动扩展**     | 并发请求自动伸缩                       |
| **按调用计费**   | 按执行时间 + 请求次数计费              |
| **事件驱动架构** | 可响应任意 AWS 服务事件                |
| **高可用**       | 多 AZ 冗余内置                         |
| **语言支持广泛** | Python, Node.js, Go, Java, C#, Ruby 等 |

------

## 🔹 计费模式

计费依据：

- 请求数（每月前 100 万次免费）
- 执行时间（以 1ms 为单位）
- 分配内存（128MB - 10GB）

> 例如：512MB 函数运行 1 秒 ≈ 0.000000834 USD

------

## 🔹 限制与注意

| 限制             | 说明                               |
| ---------------- | ---------------------------------- |
| **最大执行时间** | 15 分钟                            |
| **临时存储空间** | `/tmp` 最大 10GB                   |
| **冷启动延迟**   | 首次执行会初始化环境               |
| **无状态**       | 每次调用独立执行环境               |
| **持久数据**     | 需存储在 S3、DynamoDB 等外部服务中 |

------

## 🔹 优化与实践

✅ 将函数拆分为小型、单一职责模块；
 ✅ 启用 **Provisioned Concurrency** 预热减少冷启动；
 ✅ 使用 **Environment Variables** 管理配置；
 ✅ 敏感信息放入 **Secrets Manager / Parameter Store**；
 ✅ 使用 **Lambda Layers** 共享依赖库；
 ✅ 配合 **CloudWatch Logs + X-Ray** 监控性能。

------

## 🔹 常见架构模式

1️⃣ **Serverless Web 应用**

```
API Gateway → Lambda → DynamoDB
```

2️⃣ **S3 文件处理**

```
S3 Upload → Lambda → Process → Store in S3
```

3️⃣ **异步任务队列**

```
SNS/SQS → Lambda → Database / Analytics
```

------

## 🧠 五、三者对比总结

| 特性     | EC2                        | Fargate          | Lambda       |
| -------- | -------------------------- | ---------------- | ------------ |
| 管理模式 | 自主管理虚拟机             | 无需管理集群     | 无服务器函数 |
| 启动速度 | 分钟级                     | 秒级             | 毫秒级       |
| 成本计费 | 按实例小时                 | 按任务秒         | 按调用毫秒   |
| 可控性   | 完全控制                   | 中等             | 较低         |
| 伸缩性   | 需 ASG 配置                | 自动             | 完全自动     |
| 状态     | 可有状态                   | 无状态           | 无状态       |
| 持续运行 | 长期运行                   | 任务运行期       | 最多 15 分钟 |
| 场景     | 长期服务、数据库、系统进程 | 微服务、容器任务 | 事件触发逻辑 |

------

## ⚙️ 六、架构示例（统一对比图）

```
                ┌────────────────────┐
                │     Route 53 / ALB │
                └────────┬───────────┘
                         │
           ┌─────────────┼─────────────┐
           ▼             ▼             ▼
      EC2 (VM)       Fargate (Task)   Lambda (Function)
   ↑ Full control   ↑ No servers    ↑ Event-driven
   │ OS & runtime   │ Container     │ Short execution
   │ Long-running   │ Short/medium  │ Up to 15 min
```

------

## 🧩 七、考试与设计要点总结

| 场景                       | 正确方案                     | 考点解释         |
| -------------------------- | ---------------------------- | ---------------- |
| 长期运行的 Web 应用        | EC2 + ALB + Auto Scaling     | 持续在线服务     |
| 需要自动扩缩容的容器化任务 | ECS on Fargate               | 无需维护 EC2     |
| 短任务 / 定时函数          | Lambda                       | 按调用计费最划算 |
| 不同环境独立运行微服务     | Lambda + API Gateway         | Serverless 架构  |
| 高性能计算                 | EC2 C 系列 + Placement Group | 低延迟高带宽     |
| 批处理任务                 | Fargate / Spot EC2           | 成本优化         |
| 异步任务                   | SQS → Lambda                 | 异步高弹性处理   |

------

## ✅ 八、总结对比表

| 层级     | EC2                      | Fargate             | Lambda                  |
| -------- | ------------------------ | ------------------- | ----------------------- |
| 控制程度 | 高                       | 中                  | 低                      |
| 弹性     | 手动 / ASG               | 自动                | 自动                    |
| 运行时间 | 长期                     | 中期任务            | ≤ 15 分钟               |
| 成本模式 | 按实例                   | 按任务              | 按调用                  |
| 性能     | 高                       | 中高                | 中等                    |
| 运维需求 | 高                       | 低                  | 最低                    |
| 使用场景 | 后端服务 / 数据库 / 应用 | 容器化任务 / 微服务 | 事件驱动函数 / 定时任务 |

------

## 🧾 九、总结与选型指南

| 需求                  | 推荐服务                            | 理由                         |
| --------------------- | ----------------------------------- | ---------------------------- |
| 完全控制、长期运行    | **EC2**                             | 支持自定义内核、安装任意软件 |
| 容器化部署、无需运维  | **Fargate**                         | 自动伸缩、按任务计费         |
| 函数级事件驱动        | **Lambda**                          | 无服务器、自动扩展、超低成本 |
| 高性能批量任务        | **Spot EC2 / Fargate**              | 成本节省 70~90%              |
| 超弹性 Serverless API | **API Gateway + Lambda + DynamoDB** | 完全托管架构                 |

# 任务表述 3.3： 确定高性能数据库解决方案。

数据库性能（Aurora、DynamoDB、ElastiCache）

## 🧩 一、Amazon Aurora（高性能关系型数据库）

### 🔹 定义

**Amazon Aurora** 是 AWS 自研的**云原生关系型数据库引擎**，兼容 **MySQL** 和 **PostgreSQL**，但性能提升数倍。
 它是 **RDS（Relational Database Service）** 的一部分，但提供了更高的可用性、自动扩展性与性能。

------

## 🧠 1️⃣ Aurora 的核心架构

Aurora 拆分了传统数据库的计算与存储层：

```
         ┌─────────────┐
         │  Aurora DB  │ ← Compute Layer (Reader/Writer)
         └──────┬──────┘
                │
         ┌──────▼──────┐
         │   Shared Storage (6 copies across 3 AZs) │
         └────────────────┘
```

- 数据被自动分布到 **3 个可用区（AZ）**；
- 每个分区保留 **6 个副本**（2/3 quorum 写入确认）；
- 存储自动扩展至 **128 TB**；
- 故障时自动恢复到健康副本；
- 计算节点与存储节点分离，支持快速扩展。

------

## ⚙️ 2️⃣ 性能与高可用特性

| 特性                         | 说明                                    |
| ---------------------------- | --------------------------------------- |
| **高性能**                   | 比 MySQL 快 5 倍，比 PostgreSQL 快 3 倍 |
| **自动扩展存储**             | 无需手动分区，最大 128 TB               |
| **只读副本（Read Replica）** | 最多 15 个副本（延迟 < 20ms）           |
| **故障自动切换**             | Writer 宕机后自动提升 Reader            |
| **多 AZ 容错**               | 存储跨 AZ 同步复制                      |
| **Aurora Serverless v2**     | 按需自动扩缩计算容量（ACUs）            |

------

## 🧰 3️⃣ Aurora 优化策略

✅ **使用 Read Replica 分担读流量**（例如读写分离架构）；
 ✅ 启用 **Aurora Parallel Query**（在存储层并行扫描）；
 ✅ 对短生命周期应用使用 **Aurora Serverless v2**（自动扩缩）；
 ✅ 开启 **Backtrack**（可回溯时间点恢复）；
 ✅ 使用 **Global Database** 实现跨区域灾备与低延迟访问。

------

## 🌍 4️⃣ Aurora Global Database（跨区加速与灾备）

```
Primary Region
 ├── Writer + Readers
 └── Replicates to
Secondary Region(s)
 └── Read-only (Latency < 1s)
```

- 支持跨区域实时复制；
- 延迟 < 1 秒；
- 灾难时可在备用区快速升格为主库；
- 常用于全球分布式应用（例如多区域电商系统）。

------

## 🧾 5️⃣ Aurora 考试要点

| 场景               | 方案                   |
| ------------------ | ---------------------- |
| 跨区域低延迟访问   | Aurora Global Database |
| 自动扩展数据库容量 | Aurora Serverless      |
| 高读性能           | 多个 Read Replica      |
| 快速恢复           | Backtrack / 自动快照   |
| 容错与持久性       | 6 副本跨 3 AZ          |

------

## ⚡ 二、Amazon DynamoDB（高性能 NoSQL 数据库）

### 🔹 定义

**DynamoDB** 是 AWS 提供的**全托管 NoSQL 键值存储数据库**，以高吞吐、低延迟著称。
 它具备“**自动扩展、毫秒级响应、无限水平伸缩**”的特点，是现代无服务器架构的核心数据库。

------

## 🧠 1️⃣ 核心特性

| 特性                | 说明                                     |
| ------------------- | ---------------------------------------- |
| **键值 & 文档存储** | 可存储 JSON 格式文档                     |
| **毫秒级延迟**      | 单位毫秒响应（SSD存储）                  |
| **水平扩展**        | 按吞吐量自动分区                         |
| **高可用**          | 数据自动复制到 3 个 AZ                   |
| **无服务器模式**    | 可选择 On-Demand 计费或 Provisioned 模式 |
| **支持事务**        | ACID 事务（TransactWriteItems）          |
| **TTL**             | 自动过期数据清理                         |
| **Streams**         | 捕获数据变更事件（触发 Lambda）          |

------

## ⚙️ 2️⃣ 性能模式

| 模式                           | 特点                        | 适用场景         |
| ------------------------------ | --------------------------- | ---------------- |
| **Provisioned Mode**           | 手动设置读写容量（RCU/WCU） | 稳定工作负载     |
| **On-Demand Mode**             | 自动扩缩容量，按请求计费    | 不可预测负载     |
| **DAX (DynamoDB Accelerator)** | 内存缓存层，延迟 < 1ms      | 高频访问热点数据 |

------

## 🧩 3️⃣ 性能优化策略

✅ **使用合适的分区键（Partition Key）**，避免“热点分区”；
 ✅ **尽量减少 Scan 操作**，使用 Query 查询；
 ✅ **预留吞吐量（RCU/WCU）或使用 Auto Scaling**；
 ✅ **启用 DAX 缓存** 减少数据库压力；
 ✅ **使用 Global Table** 进行多区域复制。

------

## 🌍 4️⃣ DynamoDB Global Tables

- 跨区域多主同步；
- 所有 Region 都可读写；
- 自动冲突解决；
- 延迟通常 < 1 秒；
- 用于全球分布系统。

```
Region A ↔ Region B ↔ Region C
   ↑             ↑             ↑
   Local Users   Local Users   Local Users
```

------

## 🧰 5️⃣ 考试重点示例

| 场景             | 正确方案         |
| ---------------- | ---------------- |
| 不可预测负载     | On-Demand 模式   |
| 高频访问热点数据 | DAX 缓存         |
| 多区域实时写入   | Global Tables    |
| 自动清理过期数据 | TTL              |
| 触发 Lambda 函数 | DynamoDB Streams |

------

## 🚀 三、Amazon ElastiCache（内存缓存）

### 🔹 定义

**ElastiCache** 是 AWS 托管的**内存数据库缓存服务**，支持 **Redis** 和 **Memcached**。
 它在应用与数据库之间增加高速缓存层，大幅降低延迟、提高吞吐。

------

## 🧠 1️⃣ 架构模式

```
 Application
     │
     ▼
  ElastiCache (Redis/Memcached)
     │
     ▼
 Database (RDS / DynamoDB)
```

- 将频繁访问的数据（如查询结果、用户会话、排行榜）缓存到内存；
- 访问缓存命中率高时，数据库压力大幅下降；
- 常与 RDS 或 DynamoDB 结合使用。

------

## ⚙️ 2️⃣ Redis vs Memcached 对比

| 特性       | Redis                    | Memcached                      |
| ---------- | ------------------------ | ------------------------------ |
| 数据结构   | 键值、列表、哈希、集合   | 简单键值                       |
| 持久化     | ✅ 支持（AOF/RDB）        | ❌ 不支持                       |
| 复制与集群 | ✅ 主从复制 + 集群        | ✅ 分布式但无复制               |
| 发布订阅   | ✅ 有                     | ❌ 无                           |
| 事务       | ✅ 有                     | ❌ 无                           |
| 使用场景   | 排行榜、计数器、会话缓存 | 简单查询缓存、高速读写临时数据 |

> 考试中常问：“如果需要复杂数据结构或持久化 → 选 Redis。”

------

## 🧩 3️⃣ 性能优化机制

| 优化点                              | 说明                                  |
| ----------------------------------- | ------------------------------------- |
| **Cluster Mode**                    | 支持水平扩展多个节点（Redis Cluster） |
| **Multi-AZ Failover**               | Redis 支持主从自动切换                |
| **Parameter Tuning**                | 可调内存策略（LRU、TTL）              |
| **Encryption in Transit / At Rest** | 数据传输与存储加密                    |
| **Reserved Node Pricing**           | 降低长期使用成本                      |

------

## 🔹 ElastiCache 缓存模式

| 模式               | 架构                       | 说明             |
| ------------------ | -------------------------- | ---------------- |
| **Lazy Loading**   | 先查缓存，未命中再查数据库 | 最常见模式       |
| **Write-Through**  | 写入数据库时同时写缓存     | 数据同步         |
| **TTL Expiration** | 缓存定期过期刷新           | 控制一致性与成本 |

------

## 🧰 4️⃣ 常见使用场景

- Web 应用用户会话缓存；
- 排行榜、计数器；
- 高频读写场景；
- 减少数据库查询延迟；
- 加速 DynamoDB 读取（DAX 之外的方案）。

------

## 🧾 5️⃣ 考试要点

| 场景              | 推荐方案                        |
| ----------------- | ------------------------------- |
| 需要毫秒级访问    | ElastiCache（Redis）            |
| 高一致性 + 持久性 | Redis                           |
| 高速临时缓存      | Memcached                       |
| 多 AZ 自动切换    | Redis (Cluster Mode + Failover) |
| 简单缓存层        | Memcached                       |

------

## 🧠 四、三者协同架构（Aurora + DynamoDB + ElastiCache）

在高性能系统中，三者往往是**互补关系**：

```
           ┌─────────────────────┐
           │   Application Layer  │
           └──────────┬──────────┘
                      │
       ┌──────────────┼──────────────┐
       ▼              ▼              ▼
 ElastiCache (Redis)  DynamoDB       Aurora
  🔹 低延迟缓存层     🔹 NoSQL扩展层  🔹 关系型事务层
```

- **Aurora**：核心交易数据（强一致性、结构化）；
- **DynamoDB**：高并发访问的非结构化或键值数据；
- **ElastiCache**：缓存热点数据，减轻主数据库压力。

------

## 🧾 五、综合对比表

| 特性     | Aurora               | DynamoDB                      | ElastiCache         |
| -------- | -------------------- | ----------------------------- | ------------------- |
| 数据模型 | 关系型（SQL）        | NoSQL（键值/文档）            | 内存缓存            |
| 托管方式 | 全托管（RDS）        | 全托管                        | 全托管              |
| 性能     | 高IOPS，低延迟       | 毫秒级                        | 微秒级              |
| 扩展性   | 垂直 + 水平（副本）  | 水平自动扩展                  | 水平扩展（Cluster） |
| 一致性   | 强一致（ACID）       | 最终一致/强一致可选           | 依赖主存            |
| 可用性   | Multi-AZ + Global DB | Multi-AZ + Global Table       | Multi-AZ (Redis)    |
| 成本     | 中高                 | 中等（On-Demand/Provisioned） | 低（按节点内存）    |
| 最佳用途 | 事务型系统           | 高并发读写系统                | 缓存与加速层        |

------

## 🧩 六、考试与设计总结

| 需求             | 推荐方案                            | 关键点                   |
| ---------------- | ----------------------------------- | ------------------------ |
| 高并发 + 强事务  | **Aurora**                          | 多 AZ、高性能、ACID 支持 |
| 无服务器、高吞吐 | **DynamoDB**                        | 水平扩展、自动伸缩       |
| 超低延迟访问     | **ElastiCache (Redis)**             | 内存级响应、缓存加速     |
| 全球同步         | **Aurora Global / DynamoDB Global** | 跨区域复制               |
| 临时缓存层       | **ElastiCache Memcached**           | 简单、高速               |
| 事件驱动架构     | **DynamoDB Streams + Lambda**       | 实时反应数据变化         |

------

## 📊 七、架构总结图

```
               ┌────────────────────────┐
               │   API Gateway / ALB    │
               └──────────┬─────────────┘
                          │
                  ┌───────▼────────┐
                  │   Application   │
                  └───────┬────────┘
        ┌────────────────┼────────────────┐
        ▼                ▼                ▼
  ElastiCache       DynamoDB         Aurora
   (Redis)         (NoSQL Store)   (Relational DB)
   Cached reads     High TPS KV     Strong consistency
   µs latency       ms latency      ms latency
```

------

## ✅ 八、记忆口诀（考试速记版）

> **Aurora → SQL + 强一致 + 自动扩展**
>  **DynamoDB → NoSQL + 自动分区 + 毫秒级响应**
>  **ElastiCache → 内存缓存 + 微秒级延迟**

# 任务表述 3.4： 确定高性能和/或可扩展的网络架构。

网络优化（CloudFront、Global Accelerator）

## 🌍 一、网络优化的核心目标

在全球部署的云应用中，**网络瓶颈** 通常来源于：

- 用户与 AWS 区域（Region）之间的物理距离；
- 跨境/跨洲的高延迟；
- 动态请求与静态内容混杂；
- 区域流量路由不均衡。

AWS 提供的两种核心网络优化服务：

| 层级                   | 服务                       | 主要目标                  |
| ---------------------- | -------------------------- | ------------------------- |
| **内容层（CDN）**      | **Amazon CloudFront**      | 加速静态/动态内容传输     |
| **网络层（传输加速）** | **AWS Global Accelerator** | 优化 TCP/UDP 应用流量路由 |

------

## 🚀 二、Amazon CloudFront（全球内容分发网络 CDN）

## 🔹 定义

**Amazon CloudFront** 是 AWS 的全球 **内容分发网络（CDN）**，通过遍布全球的 **Edge Locations（边缘节点）** 缓存与加速内容分发。

其目标是：

> 🚀 把你的内容离用户更近，减少延迟、减轻源站压力。

------

## 🗺️ 1️⃣ 工作原理

```
User Request
   │
   ▼
Nearest Edge Location (CloudFront)
   │
   ├── Cache Hit → Return content directly
   └── Cache Miss → Fetch from Origin (S3 / ALB / EC2)
```

📦 **缓存机制**：

- 若边缘节点已缓存请求对象 → 直接返回；
- 若无缓存 → 回源（S3、ALB、EC2），再缓存副本。

------

## ⚙️ 2️⃣ 支持的源站类型（Origin）

| 类型                          | 说明                                     |
| ----------------------------- | ---------------------------------------- |
| **S3 Bucket**                 | 最常见，存放静态内容（图片、视频、文件） |
| **HTTP Server / EC2 / ALB**   | 动态网站、API 接口                       |
| **MediaPackage / MediaStore** | 流媒体加速（直播、点播）                 |

------

## 🧩 3️⃣ 性能与功能优化

| 功能                       | 说明                                         |
| -------------------------- | -------------------------------------------- |
| **全球分布**               | 数百个边缘节点（Edge + Regional Edge Cache） |
| **动态内容加速**           | 智能路由 + TCP 优化，支持 API 加速           |
| **内容压缩**               | 自动启用 GZIP/Brotli 压缩                    |
| **HTTP/2 & HTTP/3**        | 支持最新传输协议                             |
| **Origin Shield**          | 集中缓存层，减少源站请求量                   |
| **Lambda@Edge**            | 在边缘节点执行代码（自定义请求响应）         |
| **Field-Level Encryption** | 精细加密敏感字段                             |
| **Signed URL / Cookie**    | 控制访问权限（安全视频分发等）               |

------

## 🔒 4️⃣ 安全集成

CloudFront 与 AWS 安全体系深度整合：

- **AWS WAF（Web Application Firewall）**：防御 SQL 注入、XSS；
- **AWS Shield Standard/Advanced**：DDoS 防护；
- **ACM（AWS Certificate Manager）**：免费 SSL 证书；
- **IAM + OAI（Origin Access Identity）**：限制 S3 源访问。

------

## 💰 5️⃣ 成本优化策略

✅ 使用 **Regional Edge Cache** 提升命中率，减少源站成本；
 ✅ 设置合理的 **TTL（Cache-Control Header）**；
 ✅ 启用 **Compression** 减少传输量；
 ✅ 仅缓存常访问内容，动态请求可跳过缓存；
 ✅ 利用 **Origin Groups** 配置主备源。

------

## 💡 6️⃣ 常见使用场景

| 场景                 | 解决方案                       |
| -------------------- | ------------------------------ |
| 全球用户访问静态网站 | CloudFront + S3                |
| API 全球加速         | CloudFront + ALB（动态内容）   |
| 视频流媒体           | CloudFront + MediaPackage      |
| 边缘安全过滤         | WAF + Lambda@Edge + CloudFront |
| 内容防盗链           | Signed URL / Signed Cookie     |

------

## 🧾 7️⃣ 考试重点总结

| 考点              | 关键知识                    |
| ----------------- | --------------------------- |
| 缓存加速静态内容  | 使用 CloudFront + S3        |
| 全球加速 API 调用 | CloudFront 支持动态内容优化 |
| 边缘安全          | WAF + Shield + ACM          |
| 低延迟用户体验    | 使用 Edge Location 网络     |
| 自定义逻辑        | Lambda@Edge                 |
| 安全访问源站      | OAI 限制 S3 访问            |

------

## ⚡ 三、AWS Global Accelerator（网络层加速器）

## 🔹 定义

**AWS Global Accelerator (GA)** 是一种**网络层加速服务**，通过 AWS 全球骨干网（Global Network）优化 TCP/UDP 流量路由。

它与 CloudFront 的区别是：

> - **CloudFront**：内容层优化（HTTP/HTTPS CDN 缓存）
> - **Global Accelerator**：网络层优化（任意 TCP/UDP 应用）

------

## 🧠 1️⃣ 工作原理

```
Client → Nearest AWS Edge (Anycast IP)
         ↓
   AWS Global Network
         ↓
     Optimal AWS Region Endpoint
```

- 用户访问固定的 **Anycast IP 地址**；
- 流量自动进入最近的 AWS 边缘节点；
- 通过 AWS 专用骨干网传输到最优的终端（Endpoint）；
- 支持故障自动检测与切换。

------

## ⚙️ 2️⃣ 核心组成部分

| 组件               | 说明                                 |
| ------------------ | ------------------------------------ |
| **Accelerator**    | 入口点，提供两个全球 Anycast IP 地址 |
| **Listener**       | 监听端口与协议（TCP/UDP）            |
| **Endpoint Group** | 区域集合（Region）                   |
| **Endpoint**       | 实际服务（ALB、NLB、EC2、EIP）       |
| **Health Check**   | 监控端点健康状态并自动路由流量       |

------

## 🗺️ 3️⃣ 典型架构

```
User
 │
 ▼
Nearest Edge (Anycast IP)
 │
 ▼
AWS Global Network
 ├── Endpoint Group: us-east-1 → ALB A
 └── Endpoint Group: ap-southeast-1 → ALB B
```

👉 如果某个 Region 不可用，GA 自动把流量切到健康的 Region。

------

## ⚙️ 4️⃣ 性能与优化机制

| 特性                     | 说明                                    |
| ------------------------ | --------------------------------------- |
| **全球 Anycast IP**      | 用户始终使用同一 IP 地址访问应用        |
| **AWS Backbone Network** | 使用 AWS 内部高速网络传输（非公网路由） |
| **智能流量路由**         | 基于延迟和健康状态动态分配              |
| **内置故障转移**         | Endpoint 不健康时自动切换               |
| **加速 TCP/UDP**         | 不仅限 HTTP，可用于游戏、VoIP、API      |

------

## 🌍 5️⃣ 适用场景

| 场景                       | 说明                                   |
| -------------------------- | -------------------------------------- |
| **全球用户访问低延迟应用** | 比如金融交易平台、多人游戏、实时 API   |
| **多区域冗余部署**         | 主备 Region 流量自动切换               |
| **固定 IP 接入需求**       | CloudFront 域名变化，但 GA 提供固定 IP |
| **非 HTTP 协议应用**       | 例如 TCP/UDP、自定义协议               |

------

## 🧰 6️⃣ 与 CloudFront 的区别总结

| 对比项   | **CloudFront**             | **Global Accelerator**    |
| -------- | -------------------------- | ------------------------- |
| 层级     | 应用层（HTTP/HTTPS）       | 网络层（TCP/UDP）         |
| 主要用途 | CDN 缓存、内容分发         | 全球流量加速、故障转移    |
| IP 地址  | 使用域名                   | 提供固定 Anycast IP       |
| 缓存能力 | ✅ 有                       | ❌ 无                      |
| 协议支持 | HTTP/HTTPS                 | 所有 TCP/UDP              |
| 常见场景 | 静态网站、API、视频        | 游戏、金融、IoT、实时应用 |
| 故障转移 | 通过 Route53 或 CloudFront | 内置健康检测与自动切换    |

> ✅ **总结口诀**：
>  “要缓存选 CloudFront，要低延迟全球加速选 Global Accelerator。”

------

## 🧩 7️⃣ 成本优化与配置建议

✅ 配置多个 **Endpoint Group（跨 Region）** 提高容灾能力；
 ✅ 开启 **Health Check** 自动检测；
 ✅ 利用 **Traffic Dial** 调节流量分配比例（灰度发布）；
 ✅ 对实时流量（游戏/VoIP）使用 GA + NLB 组合；
 ✅ 对 HTTP/HTTPS 流量使用 GA + ALB 组合。

------

## 🧾 8️⃣ 考试要点总结

| 场景                | 推荐服务                 |
| ------------------- | ------------------------ |
| 静态内容分发        | CloudFront               |
| API 加速（HTTP）    | CloudFront               |
| 游戏 / 金融实时通信 | Global Accelerator       |
| 固定全球 IP         | Global Accelerator       |
| 自动流量切换        | Global Accelerator       |
| 边缘计算逻辑        | Lambda@Edge + CloudFront |

------

## 🧱 四、两者组合使用（全局优化架构）

CloudFront 与 Global Accelerator 常常**协同使用**：

- GA 提供全球网络入口与低延迟传输；
- CloudFront 提供内容缓存与边缘安全。

```
         ┌──────────────────────────┐
         │    AWS Global Accelerator │
         │  (Anycast IP + Routing)   │
         └──────────┬───────────────┘
                    │
                    ▼
           ┌──────────────────┐
           │  CloudFront CDN   │
           │ (Edge Locations)  │
           └──────────┬────────┘
                      │
        ┌─────────────┼──────────────┐
        ▼              ▼              ▼
   ALB / API         S3 Bucket     Lambda@Edge
```

- GA 提供底层网络加速；
- CloudFront 缓存与安全防护；
- ALB/S3/Lambda 提供业务逻辑。

------

## ✅ 五、总结对比表

| 特性     | **CloudFront**         | **Global Accelerator**    |
| -------- | ---------------------- | ------------------------- |
| 主要作用 | 内容分发、缓存         | 网络路由优化              |
| 工作层级 | 第 7 层（HTTP/HTTPS）  | 第 4 层（TCP/UDP）        |
| 缓存能力 | ✅ 有                   | ❌ 无                      |
| 协议支持 | HTTP/HTTPS             | 所有 TCP/UDP              |
| 全球节点 | Edge Location          | AWS Edge Network          |
| 流量切换 | Route53 + Health Check | 内置健康检测              |
| IP 地址  | 动态域名               | 固定 Anycast IP           |
| 成本     | 相对低                 | 较高（网络级）            |
| 使用场景 | 静态内容、API、视频    | 游戏、金融、IoT、实时交互 |

------

## 🧭 六、选型建议总结

| 场景                | 推荐服务                      | 理由                  |
| ------------------- | ----------------------------- | --------------------- |
| 网站静态资源加速    | **CloudFront + S3**           | 缓存内容、节省成本    |
| 全球 API 分发       | **CloudFront + ALB**          | 支持动态内容加速      |
| 实时游戏 / 金融服务 | **Global Accelerator + NLB**  | TCP/UDP 优化、低延迟  |
| 多区域容灾          | **Global Accelerator**        | 健康检查 + 流量切换   |
| 固定 IP 接入        | **Global Accelerator**        | 提供 Anycast 固定地址 |
| 内容防护            | **CloudFront + WAF + Shield** | CDN + DDoS 防御       |

------

## 🧾 七、考试高频知识点总结

| 考题方向                                     | 正确答案                  |
| -------------------------------------------- | ------------------------- |
| “要实现全球低延迟 TCP 通信”                  | Global Accelerator        |
| “需要缓存静态网页内容”                       | CloudFront                |
| “API 服务需要 HTTPS 加速”                    | CloudFront                |
| “要使用固定 IP 提供全局接入”                 | Global Accelerator        |
| “要提供 DDoS 防护与缓存加速”                 | CloudFront + Shield + WAF |
| “要对边缘请求执行逻辑（URL 重写、安全过滤）” | Lambda@Edge               |

------

## 📊 八、总结图示（考试思维图）

```
                    ┌────────────────────────────┐
                    │        Global Users         │
                    └────────────┬────────────────┘
                                 │
                      ┌──────────▼──────────┐
                      │ AWS Global Accelerator │
                      │  (Anycast IP + Route)  │
                      └──────────┬───────────┘
                                 │
                      ┌──────────▼──────────┐
                      │   CloudFront CDN     │
                      │  (Edge Caching + WAF)│
                      └──────────┬───────────┘
                         ┌───────┼─────────┐
                         ▼       ▼         ▼
                      S3       ALB       Lambda@Edge
                     (Static) (Dynamic)  (Custom Logic)
```



# 任务表述 3.5： 确定高性能的数据摄取和转换解决方案。